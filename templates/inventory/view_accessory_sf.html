{% extends "base.html" %}

{% block head %}
<style>
    /* Salesforce-style colors */
    :root {
        --sf-blue: #0176d3;
        --sf-blue-dark: #014486;
        --sf-blue-light: #1b96ff;
        --sf-gray-100: #f3f3f3;
        --sf-gray-200: #e5e5e5;
        --sf-gray-300: #c9c9c9;
        --sf-gray-600: #706e6b;
        --sf-gray-800: #3e3e3c;
        --sf-success: #2e844a;
        --sf-warning: #fe9339;
        --sf-error: #ea001e;
        --sf-purple: #9050e9;
        --sf-teal: #0b827c;
    }

    .sf-page {
        background: var(--sf-gray-100);
        min-height: 100vh;
        padding-bottom: 2rem;
    }

    /* Header */
    .sf-record-header {
        background: white;
        border-bottom: 1px solid var(--sf-gray-200);
        padding: 1rem 1.5rem;
    }

    .sf-header-top {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .sf-breadcrumb {
        font-size: 0.75rem;
        color: var(--sf-gray-600);
    }

    .sf-breadcrumb a {
        color: var(--sf-blue);
        text-decoration: none;
    }

    .sf-breadcrumb a:hover {
        text-decoration: underline;
    }

    .sf-header-main {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 1rem;
    }

    .sf-header-left {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .sf-record-icon {
        width: 48px;
        height: 48px;
        background: linear-gradient(135deg, var(--sf-teal) 0%, var(--sf-purple) 100%);
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        flex-shrink: 0;
    }

    .sf-record-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--sf-gray-800);
        margin: 0;
    }

    .sf-record-subtitle {
        font-size: 0.875rem;
        color: var(--sf-gray-600);
        margin-top: 0.25rem;
    }

    .sf-header-actions {
        display: flex;
        gap: 0.5rem;
        flex-shrink: 0;
    }

    .sf-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        font-size: 0.8125rem;
        font-weight: 600;
        border-radius: 0.25rem;
        cursor: pointer;
        transition: all 0.15s ease;
        border: 1px solid transparent;
        text-decoration: none;
    }

    .sf-btn-neutral {
        background: white;
        border-color: var(--sf-gray-300);
        color: var(--sf-gray-800);
    }

    .sf-btn-neutral:hover {
        background: var(--sf-gray-100);
    }

    .sf-btn-brand {
        background: var(--sf-blue);
        color: white;
    }

    .sf-btn-brand:hover {
        background: var(--sf-blue-dark);
    }

    /* Status badge */
    .sf-status-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.75rem;
        font-size: 0.75rem;
        font-weight: 600;
        border-radius: 1rem;
        margin-left: 0.75rem;
    }

    .sf-status-available { background: #d4edda; color: #155724; }
    .sf-status-checkedout { background: #fff3cd; color: #856404; }
    .sf-status-lowstock { background: #f8d7da; color: #721c24; }
    .sf-status-outofstock { background: #d6d8db; color: #1b1e21; }
    .sf-status-reserved { background: #e8f4ff; color: #0176d3; }
    .sf-status-disposed { background: #e2e3e5; color: #383d41; }

    /* Content layout */
    .sf-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 1.5rem;
    }

    .sf-content-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 1.5rem;
    }

    /* Better wide screen layout */
    @media (min-width: 1600px) {
        .sf-content {
            max-width: 1400px;
        }
    }

    @media (max-width: 1024px) {
        .sf-content-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Cards */
    .sf-card {
        background: white;
        border-radius: 0.5rem;
        border: 1px solid var(--sf-gray-200);
        margin-bottom: 1.5rem;
    }

    .sf-card-header {
        padding: 1rem 1.25rem;
        border-bottom: 1px solid var(--sf-gray-200);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .sf-card-title {
        font-size: 1rem;
        font-weight: 700;
        color: var(--sf-gray-800);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .sf-card-body {
        padding: 1.25rem;
    }

    /* Detail fields */
    .sf-detail-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
    }

    @media (max-width: 640px) {
        .sf-detail-grid {
            grid-template-columns: 1fr;
        }
    }

    .sf-detail-field {
        padding: 0.5rem 0;
    }

    .sf-detail-label {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--sf-gray-600);
        text-transform: uppercase;
        letter-spacing: 0.025em;
        margin-bottom: 0.25rem;
    }

    .sf-detail-value {
        font-size: 0.875rem;
        color: var(--sf-gray-800);
    }

    .sf-detail-value a {
        color: var(--sf-blue);
        text-decoration: none;
    }

    .sf-detail-value a:hover {
        text-decoration: underline;
    }

    /* Related list */
    .sf-related-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.75rem 1.25rem;
        border-bottom: 1px solid var(--sf-gray-200);
        background: var(--sf-gray-100);
    }

    .sf-related-title {
        font-size: 0.875rem;
        font-weight: 700;
        color: var(--sf-gray-800);
    }

    .sf-related-count {
        font-size: 0.75rem;
        color: white;
        background: var(--sf-blue);
        padding: 0.125rem 0.5rem;
        border-radius: 1rem;
        margin-left: 0.5rem;
    }

    .sf-related-table {
        width: 100%;
        border-collapse: collapse;
    }

    .sf-related-table th {
        text-align: left;
        padding: 0.75rem 1rem;
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--sf-gray-600);
        text-transform: uppercase;
        letter-spacing: 0.025em;
        background: var(--sf-gray-100);
        border-bottom: 1px solid var(--sf-gray-200);
    }

    .sf-related-table td {
        padding: 0.75rem 1rem;
        font-size: 0.8125rem;
        color: var(--sf-gray-800);
        border-bottom: 1px solid var(--sf-gray-200);
    }

    .sf-related-table tr:hover {
        background: #f8fafc;
    }

    .sf-related-table a {
        color: var(--sf-blue);
        text-decoration: none;
    }

    .sf-related-table a:hover {
        text-decoration: underline;
    }

    .sf-empty-state {
        padding: 2rem;
        text-align: center;
        color: var(--sf-gray-600);
        font-size: 0.875rem;
    }

    /* Timeline */
    .sf-timeline {
        padding: 1rem 1.25rem;
    }

    .sf-timeline-item {
        display: flex;
        gap: 1rem;
        padding-bottom: 1rem;
        position: relative;
    }

    .sf-timeline-item:not(:last-child)::before {
        content: '';
        position: absolute;
        left: 0.5rem;
        top: 1.5rem;
        bottom: 0;
        width: 2px;
        background: var(--sf-gray-200);
    }

    .sf-timeline-dot {
        width: 1rem;
        height: 1rem;
        background: var(--sf-teal);
        border-radius: 50%;
        flex-shrink: 0;
        margin-top: 0.25rem;
    }

    .sf-timeline-content {
        flex: 1;
    }

    .sf-timeline-title {
        font-size: 0.8125rem;
        font-weight: 600;
        color: var(--sf-gray-800);
    }

    .sf-timeline-meta {
        font-size: 0.75rem;
        color: var(--sf-gray-600);
        margin-top: 0.25rem;
    }

    .sf-timeline-details {
        font-size: 0.75rem;
        color: var(--sf-gray-600);
        margin-top: 0.5rem;
        background: var(--sf-gray-100);
        padding: 0.5rem;
        border-radius: 0.25rem;
    }

    /* Ticket status badges */
    .sf-ticket-status {
        display: inline-block;
        padding: 0.125rem 0.5rem;
        font-size: 0.6875rem;
        font-weight: 600;
        border-radius: 0.25rem;
    }

    .sf-ticket-open { background: #fef3c7; color: #92400e; }
    .sf-ticket-inprogress { background: #dbeafe; color: #1e40af; }
    .sf-ticket-pending { background: #e0e7ff; color: #3730a3; }
    .sf-ticket-resolved { background: #d1fae5; color: #065f46; }
    .sf-ticket-closed { background: #e5e7eb; color: #374151; }

    /* Highlight cards */
    .sf-highlight-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    @media (max-width: 768px) {
        .sf-highlight-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 480px) {
        .sf-highlight-grid {
            grid-template-columns: 1fr;
        }
    }

    .sf-highlight-card {
        background: white;
        border: 1px solid var(--sf-gray-200);
        border-radius: 0.5rem;
        padding: 1.25rem 1rem;
        text-align: center;
        transition: box-shadow 0.15s ease, transform 0.15s ease;
    }

    .sf-highlight-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        transform: translateY(-2px);
    }

    .sf-highlight-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--sf-blue);
        line-height: 1.2;
    }

    .sf-highlight-value.success { color: var(--sf-success); }
    .sf-highlight-value.warning { color: var(--sf-warning); }
    .sf-highlight-value.error { color: var(--sf-error); }

    .sf-highlight-label {
        font-size: 0.8125rem;
        color: var(--sf-gray-600);
        margin-top: 0.5rem;
        font-weight: 500;
    }

    /* Transaction type badges */
    .sf-transaction-type {
        display: inline-block;
        padding: 0.125rem 0.5rem;
        font-size: 0.6875rem;
        font-weight: 600;
        border-radius: 0.25rem;
    }

    .sf-transaction-checkout { background: #fef3c7; color: #92400e; }
    .sf-transaction-checkin { background: #d1fae5; color: #065f46; }
    .sf-transaction-transfer { background: #dbeafe; color: #1e40af; }
    .sf-transaction-adjustment { background: #e0e7ff; color: #3730a3; }

    /* Alias tags */
    .sf-alias-tag {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
        background: var(--sf-gray-100);
        border: 1px solid var(--sf-gray-200);
        border-radius: 0.25rem;
        margin: 0.125rem;
    }

    /* Highlights Panel */
    .sf-highlights-panel {
        background: white;
        border: 1px solid var(--sf-gray-200);
        border-radius: 0.5rem;
        margin-bottom: 1.5rem;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .sf-highlights-header {
        background: linear-gradient(135deg, var(--sf-blue) 0%, var(--sf-blue-dark) 100%);
        padding: 0.75rem 1.25rem;
        color: white;
    }

    .sf-highlights-header-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        font-weight: 600;
    }

    .sf-highlights-content {
        display: flex;
        gap: 1.5rem;
        padding: 1.5rem;
        align-items: flex-start;
    }

    /* Product Section */
    .sf-product-section {
        flex: 0 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
        padding: 1rem;
        background: linear-gradient(135deg, var(--sf-gray-100) 0%, #e8f4ff 100%);
        border-radius: 0.5rem;
        position: relative;
    }

    .sf-product-card-image {
        width: 180px;
        height: 180px;
        max-width: 200px;
        max-height: 200px;
        object-fit: contain;
        border-radius: 0.5rem;
        background: white;
        border: 1px solid var(--sf-gray-200);
    }

    .sf-product-card-placeholder {
        width: 180px;
        height: 180px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
        border-radius: 0.5rem;
        border: 1px solid var(--sf-gray-200);
        color: var(--sf-blue);
    }

    .sf-product-card-category {
        position: absolute;
        top: 0.5rem;
        left: 0.5rem;
        padding: 0.25rem 0.625rem;
        background: var(--sf-blue);
        color: white;
        font-size: 0.6875rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.03em;
        border-radius: 0.25rem;
    }

    .sf-product-edit-btn {
        position: absolute;
        bottom: 0.5rem;
        right: 0.5rem;
        padding: 0.375rem;
        background: white;
        border: 1px solid var(--sf-gray-200);
        border-radius: 0.375rem;
        cursor: pointer;
        color: var(--sf-gray-600);
        opacity: 0;
        transition: opacity 0.15s;
        box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .sf-product-section:hover .sf-product-edit-btn {
        opacity: 1;
    }

    .sf-product-edit-btn:hover {
        background: var(--sf-gray-100);
        color: var(--sf-blue);
    }

    .sf-product-info {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    /* Stats Section */
    .sf-stats-section {
        flex: 1;
        display: flex;
        align-items: center;
    }

    .sf-stats-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        width: 100%;
    }

    .sf-stat-card {
        background: white;
        border: 1px solid var(--sf-gray-200);
        border-radius: 0.5rem;
        padding: 1.25rem 1rem;
        text-align: center;
        transition: all 0.15s ease;
        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }

    .sf-stat-card:hover {
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transform: translateY(-2px);
    }

    .sf-stat-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 0.75rem;
    }

    .sf-stat-icon.blue { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color: var(--sf-blue); }
    .sf-stat-icon.green { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); color: var(--sf-success); }
    .sf-stat-icon.orange { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); color: #d97706; }
    .sf-stat-icon.purple { background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%); color: #7c3aed; }

    .sf-stat-number {
        font-size: 2rem;
        font-weight: 700;
        line-height: 1.1;
        margin-bottom: 0.25rem;
    }

    .sf-stat-number.blue { color: var(--sf-blue); }
    .sf-stat-number.green { color: var(--sf-success); }
    .sf-stat-number.orange { color: #d97706; }
    .sf-stat-number.purple { color: #7c3aed; }

    .sf-stat-label {
        font-size: 0.75rem;
        color: var(--sf-gray-600);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.02em;
    }

    /* Responsive adjustments */
    @media (max-width: 900px) {
        .sf-highlights-content {
            flex-direction: column;
            align-items: center;
        }
        .sf-stats-grid {
            grid-template-columns: repeat(4, 1fr);
        }
    }

    @media (max-width: 600px) {
        .sf-stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    .sf-image-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.5rem;
    }

    /* Image Modal */
    .sf-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
    }

    .sf-modal {
        background: white;
        border-radius: 0.5rem;
        width: 90%;
        max-width: 600px;
        max-height: 90vh;
        overflow: auto;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    .sf-modal-header {
        padding: 1rem 1.25rem;
        border-bottom: 1px solid var(--sf-gray-200);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .sf-modal-title {
        font-size: 1rem;
        font-weight: 700;
        color: var(--sf-gray-800);
    }

    .sf-modal-close {
        background: none;
        border: none;
        cursor: pointer;
        color: var(--sf-gray-600);
        padding: 0.25rem;
    }

    .sf-modal-body {
        padding: 1.25rem;
    }

    .sf-input-group {
        margin-bottom: 1rem;
    }

    .sf-input-label {
        display: block;
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--sf-gray-600);
        margin-bottom: 0.25rem;
        text-transform: uppercase;
    }

    .sf-input {
        width: 100%;
        padding: 0.5rem 0.75rem;
        border: 1px solid var(--sf-gray-300);
        border-radius: 0.25rem;
        font-size: 0.875rem;
    }

    .sf-input:focus {
        outline: none;
        border-color: var(--sf-blue);
        box-shadow: 0 0 0 3px rgba(1, 118, 211, 0.1);
    }

    .sf-suggested-images {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.75rem;
        margin-top: 1rem;
    }

    .sf-suggested-image {
        aspect-ratio: 1;
        border-radius: 0.5rem;
        overflow: hidden;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.15s ease;
    }

    .sf-suggested-image:hover {
        border-color: var(--sf-blue);
        transform: scale(1.02);
    }

    .sf-suggested-image.selected {
        border-color: var(--sf-blue);
        box-shadow: 0 0 0 3px rgba(1, 118, 211, 0.2);
    }

    .sf-suggested-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .sf-modal-footer {
        padding: 1rem 1.25rem;
        border-top: 1px solid var(--sf-gray-200);
        display: flex;
        gap: 0.5rem;
        justify-content: flex-end;
    }

    /* Full-width layout with sidebar */
    .sf-full-layout {
        display: flex;
        min-height: calc(100vh - 150px);
    }

    /* Left sidebar for navigation */
    .sf-left-sidebar {
        width: 320px;
        background: white;
        border-right: 1px solid var(--sf-gray-200);
        flex-shrink: 0;
        display: flex;
        flex-direction: column;
        height: calc(100vh - 120px);
        position: sticky;
        top: 0;
    }

    .sf-left-sidebar.collapsed {
        width: 0;
        overflow: hidden;
    }

    .sf-sidebar-scroll {
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .sf-sidebar-scroll::-webkit-scrollbar {
        width: 6px;
    }

    .sf-sidebar-scroll::-webkit-scrollbar-track {
        background: var(--sf-gray-100);
    }

    .sf-sidebar-scroll::-webkit-scrollbar-thumb {
        background: var(--sf-gray-300);
        border-radius: 3px;
    }

    .sf-sidebar-scroll::-webkit-scrollbar-thumb:hover {
        background: var(--sf-gray-600);
    }

    .sf-sidebar-header {
        padding: 1rem 1.25rem;
        border-bottom: 1px solid var(--sf-gray-200);
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--sf-gray-100);
    }

    .sf-sidebar-title {
        font-size: 0.875rem;
        font-weight: 700;
        color: var(--sf-gray-800);
    }

    .sf-sidebar-toggle {
        background: none;
        border: none;
        cursor: pointer;
        color: var(--sf-gray-600);
        padding: 0.25rem;
    }

    .sf-nav-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 1.25rem;
        border-bottom: 1px solid var(--sf-gray-200);
        cursor: pointer;
        transition: background 0.15s ease;
        text-decoration: none;
        color: inherit;
    }

    .sf-nav-item:hover {
        background: var(--sf-gray-100);
    }

    .sf-nav-item.active {
        background: #e8f4ff;
        border-left: 3px solid var(--sf-blue);
    }

    .sf-nav-item-icon {
        width: 32px;
        height: 32px;
        background: var(--sf-gray-100);
        border-radius: 0.375rem;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        overflow: hidden;
    }

    .sf-nav-item-icon img {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .sf-nav-item-icon svg {
        width: 16px;
        height: 16px;
        color: var(--sf-gray-600);
    }

    .sf-nav-item-content {
        flex: 1;
        min-width: 0;
    }

    .sf-nav-item-name {
        font-size: 0.8125rem;
        font-weight: 600;
        color: var(--sf-gray-800);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .sf-nav-item-category {
        font-size: 0.6875rem;
        color: var(--sf-gray-600);
    }

    .sf-nav-item-qty {
        font-size: 0.6875rem;
        color: var(--sf-blue);
        background: #e8f4ff;
        padding: 0.125rem 0.375rem;
        border-radius: 0.25rem;
        flex-shrink: 0;
    }

    .sf-main-content {
        flex: 1;
        overflow-y: auto;
    }

    /* Prev/Next navigation */
    .sf-record-nav {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .sf-nav-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        background: white;
        border: 1px solid var(--sf-gray-300);
        border-radius: 0.25rem;
        color: var(--sf-gray-600);
        cursor: pointer;
        transition: all 0.15s ease;
        text-decoration: none;
    }

    .sf-nav-btn:hover:not(.disabled) {
        background: var(--sf-gray-100);
        color: var(--sf-gray-800);
    }

    .sf-nav-btn.disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .sf-sidebar-section {
        padding: 0.75rem 1.25rem;
        border-bottom: 1px solid var(--sf-gray-200);
    }

    .sf-sidebar-section-title {
        font-size: 0.6875rem;
        font-weight: 600;
        color: var(--sf-gray-600);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 0.5rem;
    }

    @media (max-width: 1200px) {
        .sf-left-sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            z-index: 100;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .sf-left-sidebar.show {
            transform: translateX(0);
        }
        .sf-sidebar-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 99;
        }
        .sf-sidebar-overlay.show {
            display: block;
        }
        .sf-mobile-sidebar-toggle {
            display: inline-flex;
        }
    }

    /* Hide mobile toggle on desktop */
    .sf-mobile-sidebar-toggle {
        display: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="sf-page">
    <!-- Record Header -->
    <div class="sf-record-header">
        <div class="sf-header-top">
            <span class="sf-breadcrumb">
                <a href="{{ url_for('inventory.view_inventory_sf') }}">Inventory</a> / Accessory
            </span>
        </div>
        <div class="sf-header-main">
            <div class="sf-header-left">
                <div class="sf-record-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 7h-3a2 2 0 0 1-2-2V2"/><path d="M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z"/>
                        <path d="M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8"/>
                    </svg>
                </div>
                <div>
                    <h1 class="sf-record-title">
                        {{ accessory.name or 'Unknown Accessory' }}
                        {% if accessory.status %}
                        <span class="sf-status-badge sf-status-{{ accessory.status|lower|replace(' ', '') }}">
                            {{ accessory.status }}
                        </span>
                        {% endif %}
                    </h1>
                    <div class="sf-record-subtitle">
                        {{ accessory.category or 'No Category' }}
                        {% if accessory.model_no %} | {{ accessory.model_no }}{% endif %}
                    </div>
                </div>
            </div>
            <div class="sf-header-actions">
                <!-- Mobile Sidebar Toggle -->
                <button class="sf-mobile-sidebar-toggle sf-btn sf-btn-neutral" onclick="toggleSidebar()">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/>
                    </svg>
                </button>
                <!-- Prev/Next Navigation -->
                <div class="sf-record-nav">
                    {% if prev_accessory %}
                    <a href="{{ url_for('inventory.view_accessory_sf', accessory_id=prev_accessory.id) }}" class="sf-nav-btn" title="Previous: {{ prev_accessory.name }}">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15 18 9 12 15 6"/>
                        </svg>
                    </a>
                    {% else %}
                    <span class="sf-nav-btn disabled">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15 18 9 12 15 6"/>
                        </svg>
                    </span>
                    {% endif %}
                    {% if next_accessory %}
                    <a href="{{ url_for('inventory.view_accessory_sf', accessory_id=next_accessory.id) }}" class="sf-nav-btn" title="Next: {{ next_accessory.name }}">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </a>
                    {% else %}
                    <span class="sf-nav-btn disabled">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </span>
                    {% endif %}
                </div>
                <a href="{{ url_for('inventory.view_accessory', id=accessory.id) }}" class="sf-btn sf-btn-neutral">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                    Edit (Classic)
                </a>
                <a href="{{ url_for('inventory.view_inventory_sf') }}" class="sf-btn sf-btn-neutral">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/>
                    </svg>
                    Back to List
                </a>
            </div>
        </div>
    </div>

    <!-- Full Layout with Sidebar -->
    <div class="sf-full-layout">
        <!-- Mobile overlay -->
        <div class="sf-sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

        <!-- Left Sidebar - Accessory Navigation -->
        <div class="sf-left-sidebar" id="leftSidebar">
            <div class="sf-sidebar-header">
                <span class="sf-sidebar-title">Accessories</span>
                <button class="sf-sidebar-toggle" onclick="toggleSidebar()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>

            <!-- Scrollable content area -->
            <div class="sf-sidebar-scroll">
                <!-- Current accessory -->
                <div class="sf-sidebar-section">
                    <div class="sf-sidebar-section-title">Current</div>
                </div>
                <a href="#" class="sf-nav-item active">
                    <div class="sf-nav-item-icon">
                        {% if accessory.image_url %}
                        <img src="{{ accessory.image_url }}" alt="">
                        {% else %}
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                        </svg>
                        {% endif %}
                    </div>
                    <div class="sf-nav-item-content">
                        <div class="sf-nav-item-name">{{ accessory.name[:30] }}{% if accessory.name|length > 30 %}...{% endif %}</div>
                        <div class="sf-nav-item-category">{{ accessory.category or 'Other' }}</div>
                    </div>
                    <span class="sf-nav-item-qty">{{ accessory.available_quantity }}/{{ accessory.total_quantity }}</span>
                </a>

                <!-- Same category accessories -->
                {% if sidebar_accessories %}
                <div class="sf-sidebar-section">
                    <div class="sf-sidebar-section-title">Other Accessories</div>
                </div>
                {% for acc in sidebar_accessories %}
                <a href="{{ url_for('inventory.view_accessory_sf', accessory_id=acc.id) }}" class="sf-nav-item">
                    <div class="sf-nav-item-icon">
                        {% if acc.image_url %}
                        <img src="{{ acc.image_url }}" alt="">
                        {% else %}
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                        </svg>
                        {% endif %}
                    </div>
                    <div class="sf-nav-item-content">
                        <div class="sf-nav-item-name">{{ acc.name[:25] }}{% if acc.name|length > 25 %}...{% endif %}</div>
                        <div class="sf-nav-item-category">{{ acc.category or 'Other' }}</div>
                    </div>
                    <span class="sf-nav-item-qty">{{ acc.available_quantity }}/{{ acc.total_quantity }}</span>
                </a>
                {% endfor %}
                {% endif %}

                <!-- View All link -->
                <div class="sf-sidebar-section" style="text-align: center; padding-bottom: 1rem;">
                    <a href="{{ url_for('inventory.view_inventory_sf') }}" class="sf-btn sf-btn-neutral" style="width: 100%;">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/>
                        </svg>
                        View All Accessories
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="sf-main-content">
            <div class="sf-content">
                <!-- Highlights Panel -->
                <div class="sf-highlights-panel">
                    <div class="sf-highlights-header">
                        <span class="sf-highlights-header-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                                <path d="M2 17l10 5 10-5"/>
                                <path d="M2 12l10 5 10-5"/>
                            </svg>
                            Product Overview
                        </span>
                    </div>
                    <div class="sf-highlights-content">
                        <!-- Product Section - Left -->
                        <div class="sf-product-section">
                            <span class="sf-product-card-category">{{ accessory.category or 'Accessory' }}</span>
                            {% if accessory.image_url %}
                            <img src="{{ accessory.image_url }}" alt="{{ accessory.name }}" class="sf-product-card-image" id="productImage" onerror="this.style.display='none'; document.getElementById('imagePlaceholder').style.display='flex';">
                            <div class="sf-product-card-placeholder" style="display: none;" id="imagePlaceholder">
                                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <path d="M21 15l-5-5L5 21"/>
                                </svg>
                            </div>
                            {% else %}
                            <div class="sf-product-card-placeholder" id="imagePlaceholder">
                                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <path d="M21 15l-5-5L5 21"/>
                                </svg>
                            </div>
                            {% endif %}
                            {% if session.get('user_type') == 'DEVELOPER' %}
                            <button class="sf-product-edit-btn" onclick="openImageModal()" title="Update Image">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                                </svg>
                            </button>
                            {% endif %}
                        </div>

                        <!-- Stats Section - Right -->
                        <div class="sf-stats-section">
                        <div class="sf-stats-grid">
                            <div class="sf-stat-card">
                                <div class="sf-stat-icon blue">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                    </svg>
                                </div>
                                <div class="sf-stat-number blue">{{ accessory.total_quantity or 0 }}</div>
                                <div class="sf-stat-label">Total Stock</div>
                            </div>
                            <div class="sf-stat-card">
                                <div class="sf-stat-icon green">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                        <polyline points="22 4 12 14.01 9 11.01"/>
                                    </svg>
                                </div>
                                <div class="sf-stat-number green">{{ accessory.available_quantity or 0 }}</div>
                                <div class="sf-stat-label">Available</div>
                            </div>
                            <div class="sf-stat-card">
                                <div class="sf-stat-icon orange">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                        <circle cx="8.5" cy="7" r="4"/>
                                        <polyline points="17 11 19 13 23 9"/>
                                    </svg>
                                </div>
                                <div class="sf-stat-number orange">{{ (accessory.total_quantity or 0) - (accessory.available_quantity or 0) }}</div>
                                <div class="sf-stat-label">Checked Out</div>
                            </div>
                            <div class="sf-stat-card">
                                <div class="sf-stat-icon purple">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                        <polyline points="14,2 14,8 20,8"/>
                                    </svg>
                                </div>
                                <div class="sf-stat-number purple">{{ related_tickets|length }}</div>
                                <div class="sf-stat-label">Related Cases</div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>

        <div class="sf-content-grid">
            <!-- Left Column -->
            <div>
                <!-- Accessory Details -->
                <div class="sf-card">
                    <div class="sf-card-header">
                        <span class="sf-card-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/>
                            </svg>
                            Accessory Information
                        </span>
                    </div>
                    <div class="sf-card-body">
                        <div class="sf-detail-grid">
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Name</div>
                                <div class="sf-detail-value">{{ accessory.name or '-' }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Category</div>
                                <div class="sf-detail-value">{{ accessory.category or '-' }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Manufacturer</div>
                                <div class="sf-detail-value">{{ accessory.manufacturer or '-' }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Model No</div>
                                <div class="sf-detail-value">{{ accessory.model_no or '-' }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Status</div>
                                <div class="sf-detail-value">
                                    {% if accessory.status %}
                                    <span class="sf-status-badge sf-status-{{ accessory.status|lower|replace(' ', '') }}">
                                        {{ accessory.status }}
                                    </span>
                                    {% else %}
                                    -
                                    {% endif %}
                                </div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Country</div>
                                <div class="sf-detail-value">{{ accessory.country or '-' }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Company</div>
                                <div class="sf-detail-value">{{ accessory.company.name if accessory.company else '-' }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Inventory Details -->
                <div class="sf-card">
                    <div class="sf-card-header">
                        <span class="sf-card-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                <polyline points="3.27,6.96 12,12.01 20.73,6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/>
                            </svg>
                            Inventory Details
                        </span>
                    </div>
                    <div class="sf-card-body">
                        <div class="sf-detail-grid">
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Total Quantity</div>
                                <div class="sf-detail-value">{{ accessory.total_quantity or 0 }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Available Quantity</div>
                                <div class="sf-detail-value">{{ accessory.available_quantity or 0 }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Checked Out</div>
                                <div class="sf-detail-value">{{ (accessory.total_quantity or 0) - (accessory.available_quantity or 0) }}</div>
                            </div>
                            <div class="sf-detail-field">
                                <div class="sf-detail-label">Assigned To</div>
                                <div class="sf-detail-value">
                                    {% if customer %}
                                    {{ customer.name if customer.name else customer.email }}
                                    {% else %}
                                    -
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aliases -->
                {% if accessory.aliases %}
                <div class="sf-card">
                    <div class="sf-card-header">
                        <span class="sf-card-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 9h16M4 15h16M10 3L8 21M16 3l-2 18"/>
                            </svg>
                            Aliases
                        </span>
                    </div>
                    <div class="sf-card-body">
                        {% for alias in accessory.aliases %}
                        <span class="sf-alias-tag">{{ alias.alias_name }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Related Cases -->
                <div class="sf-card">
                    <div class="sf-related-header">
                        <span class="sf-related-title">
                            Related Cases
                            <span class="sf-related-count">{{ related_tickets|length }}</span>
                        </span>
                    </div>
                    {% if related_tickets %}
                    <table class="sf-related-table">
                        <thead>
                            <tr>
                                <th>Case Number</th>
                                <th>Subject</th>
                                <th>Status</th>
                                <th>Priority</th>
                                <th>Created</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for ticket in related_tickets %}
                            <tr>
                                <td><a href="{{ url_for('tickets.view_ticket', ticket_id=ticket.id) }}">{{ ticket.ticket_number or ticket.id }}</a></td>
                                <td>{{ ticket.subject or ticket.title or '-' }}</td>
                                <td>
                                    <span class="sf-ticket-status sf-ticket-{{ ticket.status.value|lower|replace(' ', '') if ticket.status else 'open' }}">
                                        {{ ticket.status.value if ticket.status else 'Open' }}
                                    </span>
                                </td>
                                <td>{{ ticket.priority.value if ticket.priority else '-' }}</td>
                                <td>{{ ticket.created_at|localtime('%Y-%m-%d') if ticket.created_at else '-' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <div class="sf-empty-state">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="margin: 0 auto 0.5rem; opacity: 0.5;">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                        </svg>
                        <p>No related cases found for this accessory</p>
                    </div>
                    {% endif %}
                </div>

                <!-- Transactions -->
                <div class="sf-card">
                    <div class="sf-related-header">
                        <span class="sf-related-title">
                            Recent Transactions
                            <span class="sf-related-count">{{ accessory_transactions|length }}</span>
                        </span>
                    </div>
                    {% if accessory_transactions %}
                    <table class="sf-related-table">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Quantity</th>
                                <th>User</th>
                                <th>Date</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for trans in accessory_transactions %}
                            <tr>
                                <td>
                                    <span class="sf-transaction-type sf-transaction-{{ trans.transaction_type|lower if trans.transaction_type else 'adjustment' }}">
                                        {{ trans.transaction_type or 'N/A' }}
                                    </span>
                                </td>
                                <td>{{ trans.quantity or 0 }}</td>
                                <td>{{ trans.user.username if trans.user else '-' }}</td>
                                <td>{{ trans.transaction_date|localtime('%Y-%m-%d') if trans.transaction_date else '-' }}</td>
                                <td>{{ trans.notes or '-' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <div class="sf-empty-state">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="margin: 0 auto 0.5rem; opacity: 0.5;">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                        <p>No transactions recorded</p>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Right Column -->
            <div>
                <!-- Notes -->
                <div class="sf-card">
                    <div class="sf-card-header">
                        <span class="sf-card-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/>
                            </svg>
                            Notes
                        </span>
                    </div>
                    <div class="sf-card-body">
                        <div class="sf-detail-value" style="white-space: pre-wrap;">{{ accessory.notes or 'No notes' }}</div>
                    </div>
                </div>

                <!-- Checkout Info -->
                <div class="sf-card">
                    <div class="sf-card-header">
                        <span class="sf-card-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
                            </svg>
                            Checkout Information
                        </span>
                    </div>
                    <div class="sf-card-body">
                        <div class="sf-detail-field">
                            <div class="sf-detail-label">Checkout Date</div>
                            <div class="sf-detail-value">{{ accessory.checkout_date|localtime('%Y-%m-%d %H:%M') if accessory.checkout_date else '-' }}</div>
                        </div>
                        <div class="sf-detail-field">
                            <div class="sf-detail-label">Return Date</div>
                            <div class="sf-detail-value">{{ accessory.return_date|localtime('%Y-%m-%d %H:%M') if accessory.return_date else '-' }}</div>
                        </div>
                    </div>
                </div>

                <!-- Activity Timeline -->
                <div class="sf-card">
                    <div class="sf-card-header">
                        <span class="sf-card-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
                            </svg>
                            Recent Activity
                        </span>
                    </div>
                    {% if accessory_history %}
                    <div class="sf-timeline">
                        {% for entry in accessory_history %}
                        <div class="sf-timeline-item">
                            <div class="sf-timeline-dot"></div>
                            <div class="sf-timeline-content">
                                <div class="sf-timeline-title">{{ entry.action }}</div>
                                <div class="sf-timeline-meta">
                                    {{ entry.created_at|localtime('%Y-%m-%d %H:%M') if entry.created_at else '' }}
                                    {% if entry.user %} by {{ entry.user.username }}{% endif %}
                                </div>
                                {% if entry.notes %}
                                <div class="sf-timeline-details">{{ entry.notes }}</div>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="sf-empty-state">
                        <p>No activity recorded</p>
                    </div>
                    {% endif %}
                </div>

                <!-- System Info -->
                <div class="sf-card">
                    <div class="sf-card-header">
                        <span class="sf-card-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                            </svg>
                            System Information
                        </span>
                    </div>
                    <div class="sf-card-body">
                        <div class="sf-detail-field">
                            <div class="sf-detail-label">Accessory ID</div>
                            <div class="sf-detail-value">{{ accessory.id }}</div>
                        </div>
                        <div class="sf-detail-field">
                            <div class="sf-detail-label">Created</div>
                            <div class="sf-detail-value">{{ accessory.created_at|localtime('%Y-%m-%d %H:%M') if accessory.created_at else '-' }}</div>
                        </div>
                        <div class="sf-detail-field">
                            <div class="sf-detail-label">Last Updated</div>
                            <div class="sf-detail-value">{{ accessory.updated_at|localtime('%Y-%m-%d %H:%M') if accessory.updated_at else '-' }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Update Modal -->
<div class="sf-modal-overlay" id="imageModal" style="display: none;">
    <div class="sf-modal">
        <div class="sf-modal-header">
            <span class="sf-modal-title">Update Product Image</span>
            <button class="sf-modal-close" onclick="closeImageModal()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="sf-modal-body">
            <div class="sf-input-group">
                <label class="sf-input-label">Image URL</label>
                <input type="text" class="sf-input" id="imageUrlInput" placeholder="https://example.com/image.jpg" value="{{ accessory.image_url or '' }}">
            </div>
            <p style="font-size: 0.75rem; color: var(--sf-gray-600); margin-bottom: 1rem;">
                Enter a direct image URL, or select from suggested images below based on category.
            </p>
            <div class="sf-input-label">Suggested Images for "{{ accessory.category }}"</div>
            <div class="sf-suggested-images" id="suggestedImages">
                <!-- Will be populated by JS -->
            </div>
        </div>
        <div class="sf-modal-footer">
            <button class="sf-btn sf-btn-neutral" onclick="closeImageModal()">Cancel</button>
            <button class="sf-btn sf-btn-neutral" onclick="clearImage()">Remove Image</button>
            <button class="sf-btn sf-btn-brand" onclick="saveImage()">Save Image</button>
        </div>
    </div>
</div>

<script>
// Category-based SVG icons for accessories
const categoryIcons = {
    'Keyboard': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="2" y="6" width="20" height="12" rx="2"/>
        <path d="M6 10h.01M10 10h.01M14 10h.01M18 10h.01"/>
        <path d="M6 14h.01M18 14h.01"/>
        <path d="M8 14h8"/>
    </svg>`,
    'Mouse': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="6" y="3" width="12" height="18" rx="6"/>
        <line x1="12" y1="7" x2="12" y2="11"/>
    </svg>`,
    'Monitor': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="2" y="3" width="20" height="14" rx="2"/>
        <line x1="8" y1="21" x2="16" y2="21"/>
        <line x1="12" y1="17" x2="12" y2="21"/>
    </svg>`,
    'Headset': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M3 18v-6a9 9 0 0 1 18 0v6"/>
        <path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"/>
    </svg>`,
    'Headphone': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M3 18v-6a9 9 0 0 1 18 0v6"/>
        <path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"/>
    </svg>`,
    'Audio': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
        <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
    </svg>`,
    'Cable': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M17 21v-2a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v2"/>
        <path d="M7 3v2a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V3"/>
        <path d="M12 6v12"/>
        <circle cx="12" cy="12" r="2"/>
    </svg>`,
    'Charger': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M5 18H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3.19M15 6h2.81a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H17"/>
        <path d="M11 6l-4 6h6l-4 6"/>
    </svg>`,
    'Power Adapter': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="2" y="7" width="16" height="10" rx="2"/>
        <path d="M22 12h-4"/>
        <path d="M6 11v2M10 11v2"/>
    </svg>`,
    'Adapter': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="4" y="4" width="16" height="6" rx="1"/>
        <rect x="4" y="14" width="16" height="6" rx="1"/>
        <path d="M9 10v4M15 10v4"/>
    </svg>`,
    'Docking Station': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="2" y="8" width="20" height="10" rx="2"/>
        <path d="M6 12h.01M10 12h.01M14 12h.01M18 12h.01"/>
        <path d="M8 4h8"/>
        <path d="M12 4v4"/>
    </svg>`,
    'NFC Key': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="3" y="11" width="18" height="11" rx="2"/>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        <circle cx="12" cy="16" r="1"/>
    </svg>`,
    'Screen Protector': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="5" y="2" width="14" height="20" rx="2"/>
        <rect x="7" y="4" width="10" height="14" rx="1"/>
        <circle cx="12" cy="20" r="1"/>
    </svg>`,
    'Accessories': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <circle cx="12" cy="12" r="3"/>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
    </svg>`,
    'Other': `<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="3" y="3" width="18" height="18" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M9 21V9"/>
    </svg>`
};

// Suggested Unsplash images by category
const suggestedImages = {
    'Keyboard': [
        'https://images.unsplash.com/photo-1587829741301-dc798b83add3?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1595225476474-87563907a212?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1541140532154-b024d705b90a?w=400&h=400&fit=crop'
    ],
    'Mouse': [
        'https://images.unsplash.com/photo-1527864550417-7fd91fc51a46?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1615663245857-ac93bb7c39e7?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1605773527852-c546a8584ea3?w=400&h=400&fit=crop'
    ],
    'Monitor': [
        'https://images.unsplash.com/photo-1527443224154-c4a3942d3acf?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1593642632559-0c6d3fc62b89?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1585792180666-f7347c490ee2?w=400&h=400&fit=crop'
    ],
    'Headset': [
        'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1583394838336-acd977736f90?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1484704849700-f032a568e944?w=400&h=400&fit=crop'
    ],
    'Headphone': [
        'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1583394838336-acd977736f90?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1546435770-a3e426bf472b?w=400&h=400&fit=crop'
    ],
    'Audio': [
        'https://images.unsplash.com/photo-1545454675-3531b543be5d?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1558089687-f282ffcbc126?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1608043152269-423dbba4e7e1?w=400&h=400&fit=crop'
    ],
    'Cable': [
        'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1601944179066-29786cb9d32a?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1597872200969-2b65d56bd16b?w=400&h=400&fit=crop'
    ],
    'Charger': [
        'https://images.unsplash.com/photo-1583863788434-e62bd23c3da2?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1609091839311-d5365f9ff1c5?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1618410320928-25228d811631?w=400&h=400&fit=crop'
    ],
    'Power Adapter': [
        'https://images.unsplash.com/photo-1583863788434-e62bd23c3da2?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1609091839311-d5365f9ff1c5?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1618410320928-25228d811631?w=400&h=400&fit=crop'
    ],
    'Adapter': [
        'https://images.unsplash.com/photo-1625772452859-1c03d5bf1137?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1597872200969-2b65d56bd16b?w=400&h=400&fit=crop'
    ],
    'Docking Station': [
        'https://images.unsplash.com/photo-1593062096033-9a26b09da705?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1625772452859-1c03d5bf1137?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1591488320449-011701bb6704?w=400&h=400&fit=crop'
    ],
    'default': [
        'https://images.unsplash.com/photo-1518770660439-4636190af475?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1519389950473-47ba0277781c?w=400&h=400&fit=crop',
        'https://images.unsplash.com/photo-1531297484001-80022131f5a1?w=400&h=400&fit=crop'
    ]
};

const accessoryId = {{ accessory.id }};
const accessoryCategory = '{{ accessory.category or "default" }}';

// Get category and render placeholder
document.addEventListener('DOMContentLoaded', function() {
    const placeholder = document.getElementById('imagePlaceholder');
    if (placeholder && placeholder.style.display !== 'none') {
        const category = '{{ accessory.category or "Other" }}';
        const icon = categoryIcons[category] || categoryIcons['Other'];
        placeholder.innerHTML = icon;
    }

    // Load suggested images
    loadSuggestedImages();
});

// Load suggested images for the category
function loadSuggestedImages() {
    const container = document.getElementById('suggestedImages');
    const images = suggestedImages[accessoryCategory] || suggestedImages['default'];

    container.innerHTML = images.map(url => `
        <div class="sf-suggested-image" onclick="selectImage('${url}')">
            <img src="${url}" alt="Suggested image" onerror="this.parentElement.style.display='none'">
        </div>
    `).join('');
}

// Open image modal
function openImageModal() {
    document.getElementById('imageModal').style.display = 'flex';
}

// Close image modal
function closeImageModal() {
    document.getElementById('imageModal').style.display = 'none';
}

// Select image from suggestions
function selectImage(url) {
    document.getElementById('imageUrlInput').value = url;

    // Update visual selection
    document.querySelectorAll('.sf-suggested-image').forEach(el => {
        el.classList.remove('selected');
    });
    event.currentTarget.classList.add('selected');
}

// Save image
async function saveImage() {
    const imageUrl = document.getElementById('imageUrlInput').value.trim();

    try {
        const response = await fetch(`/inventory/api/sf/accessory/${accessoryId}/image`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ image_url: imageUrl })
        });

        const data = await response.json();
        if (data.success) {
            // Update the displayed image
            const productImage = document.getElementById('productImage');
            const placeholder = document.getElementById('imagePlaceholder');

            if (imageUrl) {
                productImage.src = imageUrl;
                productImage.style.display = 'block';
                placeholder.style.display = 'none';
            } else {
                productImage.style.display = 'none';
                placeholder.style.display = 'flex';
                const category = '{{ accessory.category or "Other" }}';
                placeholder.innerHTML = categoryIcons[category] || categoryIcons['Other'];
            }

            closeImageModal();
        } else {
            alert('Error saving image: ' + (data.error || 'Unknown error'));
        }
    } catch (error) {
        alert('Error saving image: ' + error.message);
    }
}

// Clear image
async function clearImage() {
    document.getElementById('imageUrlInput').value = '';
    await saveImage();
}

// Close modal on overlay click
document.getElementById('imageModal')?.addEventListener('click', function(e) {
    if (e.target === this) {
        closeImageModal();
    }
});

// Toggle sidebar visibility (mobile)
function toggleSidebar() {
    const sidebar = document.getElementById('leftSidebar');
    const overlay = document.getElementById('sidebarOverlay');

    if (sidebar && overlay) {
        sidebar.classList.toggle('show');
        overlay.classList.toggle('show');
    }
}

// Mobile sidebar toggle button handler
document.addEventListener('DOMContentLoaded', function() {
    // Check if we're on mobile and add toggle button to header if needed
    const mobileToggleBtn = document.querySelector('.sf-mobile-sidebar-toggle');
    if (mobileToggleBtn) {
        mobileToggleBtn.addEventListener('click', toggleSidebar);
    }
});
</script>
{% endblock %}
