{% extends "base.html" %}

{% block title %}{% if test_case %}Edit{% else %}Create{% endif %} Test Case - {{ feature.display_id }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="mb-6">
            <h1 class="text-3xl font-bold text-gray-900">
                {% if test_case %}Edit{% else %}Create{% endif %} Test Case
            </h1>
            <p class="text-gray-600 mt-1">
                For Bug: {{ feature.display_id }} - {{ feature.title }}
            </p>
        </div>

        <!-- Form -->
        <form method="POST" class="bg-white rounded-lg shadow p-6">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <div class="space-y-6">
                <!-- Title -->
                <div>
                    <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
                        Test Case Title <span class="text-red-500">*</span>
                    </label>
                    <input type="text"
                           name="title"
                           id="title"
                           required
                           class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           placeholder="Brief title describing what is being tested"
                           value="{{ test_case.title if test_case else '' }}">
                </div>

                <!-- Description -->
                <div>
                    <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                        Description
                    </label>
                    <textarea name="description"
                              id="description"
                              rows="3"
                              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              placeholder="Additional context or details about this test case">{{ test_case.description if test_case else '' }}</textarea>
                </div>

                <!-- Priority -->
                <div>
                    <label for="priority" class="block text-sm font-medium text-gray-700 mb-2">
                        Priority
                    </label>
                    <select name="priority"
                            id="priority"
                            class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="Low" {% if test_case and test_case.priority == 'Low' %}selected{% endif %}>Low</option>
                        <option value="Medium" {% if not test_case or test_case.priority == 'Medium' %}selected{% endif %}>Medium</option>
                        <option value="High" {% if test_case and test_case.priority == 'High' %}selected{% endif %}>High</option>
                    </select>
                </div>

                <!-- Preconditions -->
                <div>
                    <label for="preconditions" class="block text-sm font-medium text-gray-700 mb-2">
                        Preconditions
                    </label>
                    <textarea name="preconditions"
                              id="preconditions"
                              rows="3"
                              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              placeholder="What needs to be set up or in place before testing?&#10;Example:&#10;- User must be logged in&#10;- Test data must be created&#10;- Feature flag must be enabled">{{ test_case.preconditions if test_case else '' }}</textarea>
                    <p class="text-sm text-gray-500 mt-1">State or conditions that must exist before the test can be executed</p>
                </div>

                <!-- Test Steps -->
                <div>
                    <label for="test_steps" class="block text-sm font-medium text-gray-700 mb-2">
                        Test Steps <span class="text-red-500">*</span>
                    </label>
                    <textarea name="test_steps"
                              id="test_steps"
                              rows="6"
                              required
                              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              placeholder="Step-by-step instructions for testing:&#10;1. Navigate to the login page&#10;2. Enter valid username and password&#10;3. Click the 'Login' button&#10;4. Verify user is redirected to dashboard">{{ test_case.test_steps if test_case else '' }}</textarea>
                    <p class="text-sm text-gray-500 mt-1">Detailed step-by-step instructions for executing the test</p>
                </div>

                <!-- Expected Result -->
                <div>
                    <label for="expected_result" class="block text-sm font-medium text-gray-700 mb-2">
                        Expected Result <span class="text-red-500">*</span>
                    </label>
                    <textarea name="expected_result"
                              id="expected_result"
                              rows="4"
                              required
                              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              placeholder="What should happen when the test is executed?&#10;Example:&#10;- User successfully logs in&#10;- Dashboard displays with correct user information&#10;- No error messages are shown">{{ test_case.expected_result if test_case else '' }}</textarea>
                    <p class="text-sm text-gray-500 mt-1">What should happen if the feature works correctly</p>
                </div>

                <!-- Test Data -->
                <div>
                    <label for="test_data" class="block text-sm font-medium text-gray-700 mb-2">
                        Test Data
                    </label>
                    <textarea name="test_data"
                              id="test_data"
                              rows="3"
                              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                              placeholder="Any specific data needed for testing:&#10;- Username: test@example.com&#10;- Password: Test123!&#10;- Test Account ID: 12345">{{ test_case.test_data if test_case else '' }}</textarea>
                    <p class="text-sm text-gray-500 mt-1">Specific data, accounts, or values needed for testing</p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="mt-8 flex justify-end space-x-3">
                <a href="{{ url_for('development.feature_test_cases', feature_id=feature.id) }}"
                   class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                    Cancel
                </a>
                <button type="submit"
                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                    {% if test_case %}Update{% else %}Create{% endif %} Test Case
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
