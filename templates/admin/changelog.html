{% extends "base.html" %}

{% block title %}Changelog - {{ version_info.name }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h1 class="text-3xl font-bold">Changelog</h1>
                <p class="text-gray-600 mt-2">{{ version_info.name }} - Version History & Updates</p>
            </div>
            <a href="{{ url_for('admin.system_config') }}" class="text-gray-600 hover:text-gray-800">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
            </a>
        </div>

        <!-- Current Version Info -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <svg class="h-6 w-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-blue-800">Current Version</h3>
                    <div class="mt-2 text-sm text-blue-700">
                        <p><strong>{{ version_info.version_full }}</strong> - {{ version_info.codename }}</p>
                        <p>Built on {{ version_info.build_date }} at {{ version_info.build_time }}</p>
                        {% if version_info.git_commit != 'unknown' %}
                        <p>Git: {{ version_info.git_branch }}@{{ version_info.git_commit }}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Changelog Entries -->
        <div class="space-y-8">

            <!-- Version 8.2.2 -->
            <div class="border-l-4 border-green-500 pl-6">
                <div class="flex items-center mb-3">
                    <h2 class="text-xl font-semibold text-gray-900">v8.2.2</h2>
                    <span class="ml-3 px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full">Latest</span>
                    <span class="ml-2 text-sm text-gray-500">Released: 2024-12-01</span>
                </div>
                <div class="space-y-3">
                    <div>
                        <h3 class="font-medium text-green-700">âœ¨ New Features</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸ‘¥ <strong>@Mention Visibility Control:</strong> Country Admins/Supervisors can now control which users and groups each user can see in @mention suggestions</li>
                            <li>ğŸ“Š <strong>Salesforce-style Ticket List:</strong> New ticket list view with charts, sidebar filtering, and modern SF design</li>
                            <li>ğŸ“ <strong>Bulk Edit Manager:</strong> Bulk edit Name, Asset Tag, and Serial Number for SF inventory page</li>
                            <li>ğŸ¨ <strong>Custom Ticket Statuses:</strong> Create and manage custom ticket statuses with color coding</li>
                            <li>ğŸ”„ <strong>CLOSED_DUPLICATED Status:</strong> New status with auto-return functionality for duplicate tickets</li>
                            <li>ğŸ“¥ <strong>Import from Retool:</strong> Direct import functionality from Retool with accessory support</li>
                            <li>ğŸ“¦ <strong>1stbase Bulk Import:</strong> Bulk import functionality for returns processing</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-blue-700">ğŸ”§ Improvements</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸ“Š <strong>Advanced Case Reports:</strong> Redesigned with Salesforce-style UI and more chart types</li>
                            <li>ğŸ”„ <strong>Internal Transfer Form:</strong> Redesigned with offboarding/onboarding workflow separation</li>
                            <li>ğŸ” <strong>Select2 Dropdowns:</strong> Searchable dropdowns for customer and country fields</li>
                            <li>ğŸŒ <strong>World Countries:</strong> Complete list of world countries added to customer forms</li>
                            <li>ğŸ‘ï¸ <strong>SUPERVISOR Permissions:</strong> Company permission filtering for SUPERVISOR users</li>
                            <li>âœ… <strong>Select All Countries:</strong> Button to select all countries with auto-select for SUPERVISOR</li>
                            <li>ğŸ“¦ <strong>Accessory Auto-Status:</strong> Accessory status auto-updates when quantity changes</li>
                            <li>ğŸ” <strong>CSV Import:</strong> Duplicate detection in preview and improved error messages</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-red-700">ğŸ› Bug Fixes</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Fixed asset unlink with direct SQL to bypass ORM caching issues</li>
                            <li>Fixed DetachedInstanceError on Salesforce-style ticket list</li>
                            <li>Fixed custom status display showing 'None' in ticket view</li>
                            <li>Fixed JSON serialization errors for priorities enum and CustomTicketStatus</li>
                            <li>Fixed customer address preservation in bulk import preview</li>
                            <li>Fixed Internal Transfer ticket creation validation</li>
                            <li>Fixed erase status update error - store old value before updating</li>
                            <li>Fixed incorrect route name in development dashboard</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-orange-700">ğŸ—„ï¸ Database Changes</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Added user_mention_permissions table for @mention visibility control</li>
                            <li>Added mention_filter_enabled column to users table</li>
                            <li>Added custom_status column to tickets table</li>
                            <li>Added custom_ticket_statuses table for custom status management</li>
                            <li>Added image_url column to assets and accessories tables</li>
                            <li>Added preferences column to users table</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Version 8.2.1.2 -->
            <div class="border-l-4 border-blue-500 pl-6">
                <div class="flex items-center mb-3">
                    <h2 class="text-xl font-semibold text-gray-900">v8.2.1.2</h2>
                    <span class="ml-3 px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">Previous</span>
                    <span class="ml-2 text-sm text-gray-500">Released: {{ version_info.build_date }}</span>
                </div>
                <div class="space-y-3">
                    <div>
                        <h3 class="font-medium text-green-700">âœ¨ New Features</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸ“š <strong>Knowledge Base System:</strong> Complete knowledge management with articles, categories, and tags</li>
                            <li>ğŸ” <strong>Knowledge Base Permissions:</strong> Granular permission control for viewing, creating, editing, and deleting articles</li>
                            <li>ğŸ“ <strong>Article Management:</strong> Rich text editor with support for attachments and feedback</li>
                            <li>ğŸ·ï¸ <strong>Category System:</strong> Hierarchical organization of knowledge articles</li>
                            <li>ğŸ” <strong>Advanced Search:</strong> Full-text search across articles with filtering by category and tags</li>
                            <li>ğŸ‘¥ <strong>User Feedback:</strong> Rating and comment system for knowledge articles</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-blue-700">ğŸ”§ Improvements</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸŒ <strong>CSV Import Enhancement:</strong> Country field now uses city data for better geographical accuracy</li>
                            <li>ğŸ¯ <strong>Permission Management UI:</strong> Added Knowledge Base permissions to admin interface</li>
                            <li>ğŸ  <strong>Home Dashboard:</strong> Knowledge Base section with permission-based visibility</li>
                            <li>ğŸ¨ <strong>Navigation Cleanup:</strong> Removed Knowledge Base link from main navigation for cleaner interface</li>
                            <li>ğŸ“Š <strong>Admin Dashboard:</strong> Knowledge Base administration panel with article statistics</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-purple-700">ğŸ¯ User Experience</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸ“– <strong>Article Visibility:</strong> Support for public, internal, and restricted article access levels</li>
                            <li>ğŸ”„ <strong>Version Control:</strong> Track article revisions and publication status</li>
                            <li>ğŸ“± <strong>Responsive Design:</strong> Mobile-friendly knowledge base interface</li>
                            <li>ğŸ¨ <strong>Rich Content:</strong> Support for formatted text, images, and file attachments</li>
                            <li>â­ <strong>Feedback System:</strong> Users can rate articles and provide comments</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-red-700">ğŸ› Bug Fixes</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Fixed CSV import country field displaying "Country.SG" instead of proper country names</li>
                            <li>Resolved customer country display issues in ticket view templates</li>
                            <li>Fixed city-to-country mapping for better geographical data accuracy</li>
                            <li>Corrected permission checks for Knowledge Base access control</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-orange-700">ğŸ—„ï¸ Database Changes</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Added knowledge_articles table with full-text search support</li>
                            <li>Added knowledge_categories table with hierarchical structure</li>
                            <li>Added knowledge_tags table for article tagging</li>
                            <li>Added knowledge_feedback table for user ratings and comments</li>
                            <li>Added knowledge_attachments table for file uploads</li>
                            <li>Updated permissions table with Knowledge Base permission fields</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Version 8.2.1 -->
            <div class="border-l-4 border-blue-500 pl-6">
                <div class="flex items-center mb-3">
                    <h2 class="text-xl font-semibold text-gray-900">v8.2.1</h2>
                    <span class="ml-3 px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">Previous</span>
                    <span class="ml-2 text-sm text-gray-500">Released: {{ version_info.build_date }}</span>
                </div>
                <div class="space-y-3">
                    <div>
                        <h3 class="font-medium text-green-700">âœ¨ New Features</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸ¯ <strong>Salesforce-style Tab System:</strong> Persistent tabs across navigation with session storage</li>
                            <li>ğŸ“Š <strong>Audit Reports Management:</strong> View completed inventory audit reports with detailed analysis</li>
                            <li>ğŸ”§ <strong>Audit Remediation:</strong> Direct access to remediation tools from audit reports</li>
                            <li>ğŸ  <strong>Enhanced Home Dashboard:</strong> Dedicated Inventory Audit card with integrated functionality</li>
                            <li>âŒ¨ï¸ <strong>Keyboard Shortcuts:</strong> Ctrl+W (close tab), Ctrl+T (new tab), Ctrl+1 (home)</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-blue-700">ğŸ”§ Improvements</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸ¨ <strong>UI/UX Enhancements:</strong> Improved ticket view with better navigation and styling</li>
                            <li>ğŸ‘¥ <strong>Customer Information:</strong> Added comprehensive customer details for Asset Return (claw) tickets</li>
                            <li>ğŸ” <strong>Case-Insensitive Filtering:</strong> Fixed inventory status filter to work with any case format</li>
                            <li>ğŸ“± <strong>Responsive Design:</strong> Tab system works seamlessly across all screen sizes</li>
                            <li>ğŸŒ™ <strong>Dark Mode Support:</strong> Full dark theme compatibility for all new features</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-purple-700">ğŸ¯ User Experience</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>ğŸ“‹ <strong>Audit Report Details:</strong> Tabbed interface for scanned, missing, and unexpected assets</li>
                            <li>ğŸ–¨ï¸ <strong>Print Functionality:</strong> Print-ready audit reports with proper formatting</li>
                            <li>ğŸ”„ <strong>Persistent Navigation:</strong> Tabs maintain state across page refreshes and navigation</li>
                            <li>ğŸ“Š <strong>Visual Progress Indicators:</strong> Completion percentages and progress bars for audits</li>
                            <li>ğŸ¨ <strong>Consistent Styling:</strong> Unified design language across all new components</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-red-700">ğŸ› Bug Fixes</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Fixed inventory status filter case sensitivity issues (IN STOCK vs in stock)</li>
                            <li>Resolved missing customer information display for Asset Return tickets</li>
                            <li>Fixed tab positioning to appear below navigation bar instead of above</li>
                            <li>Corrected duplicate card issues on home dashboard</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Version 0.5.1 -->
            <div class="border-l-4 border-gray-300 pl-6">
                <div class="flex items-center mb-3">
                    <h2 class="text-xl font-semibold text-gray-900">v0.5.1</h2>
                    <span class="ml-2 text-sm text-gray-500">Released: 2025-06-22</span>
                </div>
                <div class="space-y-3">
                    <div>
                        <h3 class="font-medium text-green-700">âœ¨ New Features</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Added version management system with build tracking</li>
                            <li>Implemented changelog page for release notes</li>
                            <li>Enhanced System Configuration with version information</li>
                            <li>Fixed custom ticket category shipping tracking visibility</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-blue-700">ğŸ”§ Improvements</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Improved ticket creation form logic for custom categories</li>
                            <li>Enhanced section-based field visibility for custom categories</li>
                            <li>Better error handling in ticket category selection</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-red-700">ğŸ› Bug Fixes</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Fixed shipping tracking fields showing for all custom categories</li>
                            <li>Resolved "Data Erased" field showing incorrect values</li>
                            <li>Fixed BuildError with ticket URLs in search results</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Version 0.5.0 -->
            <div class="border-l-4 border-gray-300 pl-6">
                <div class="flex items-center mb-3">
                    <h2 class="text-xl font-semibold text-gray-900">v0.5.0</h2>
                    <span class="ml-2 text-sm text-gray-500">Released: 2024-12-01</span>
                </div>
                <div class="space-y-3">
                    <div>
                        <h3 class="font-medium text-green-700">ğŸ‰ Major Release</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Complete inventory management system implementation</li>
                            <li>Custom ticket category creation and management</li>
                            <li>Advanced asset tracking and management</li>
                            <li>Multi-carrier shipping integration</li>
                            <li>Customer management system</li>
                            <li>Email notification system</li>
                            <li>User roles and permissions</li>
                            <li>Queue management for ticket assignment</li>
                            <li>File attachments and document management</li>
                            <li>Comprehensive search functionality</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-blue-700">ğŸ”§ Core Features</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Multi-tenant support with company management</li>
                            <li>Asset lifecycle tracking (checkout, return, repair)</li>
                            <li>Integrated shipping carriers (DHL, UPS, SingPost, etc.)</li>
                            <li>Real-time tracking updates</li>
                            <li>Advanced filtering and reporting</li>
                            <li>Mobile-responsive design</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Upcoming Versions -->
            <div class="border-l-4 border-yellow-400 pl-6">
                <div class="flex items-center mb-3">
                    <h2 class="text-xl font-semibold text-gray-900">Roadmap</h2>
                    <span class="ml-3 px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full">Planned</span>
                </div>
                <div class="space-y-3">
                    <div>
                        <h3 class="font-medium text-purple-700">ğŸš€ v8.3.0 - Advanced Analytics</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Enhanced audit analytics and trends</li>
                            <li>Asset utilization reporting</li>
                            <li>Performance metrics dashboard</li>
                            <li>Automated audit scheduling</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-purple-700">ğŸš€ v8.4.0 - Mobile & API</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Mobile-optimized audit interface</li>
                            <li>REST API for external integrations</li>
                            <li>Barcode scanning improvements</li>
                            <li>Offline audit capabilities</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-purple-700">ğŸš€ v9.0.0 - Enterprise Features</h3>
                        <ul class="mt-2 list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>Multi-location audit management</li>
                            <li>Advanced user roles and permissions</li>
                            <li>Automated compliance reporting</li>
                            <li>Integration with enterprise systems</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Version Update Instructions -->
        <div class="mt-12 bg-gray-50 border border-gray-200 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">
                <svg class="inline w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                Version Management
            </h3>
            <div class="text-sm text-gray-600 space-y-2">
                <p><strong>For Developers:</strong> Update version numbers in <code>version.py</code></p>
                <p><strong>Build Increment:</strong> Each deployment automatically increments the build number</p>
                <p><strong>Release Process:</strong> Update changelog, increment version, commit, and deploy</p>
                <p><strong>Git Integration:</strong> Version info includes git commit hash and branch information</p>
            </div>
        </div>
    </div>
</div>
{% endblock %} 